<script lang="ts">
	import type { MotorCommandType } from '$lib/client-server-lib/types';
	import Icon from '@iconify/svelte';
	import { GlobalMotorCommandsGrouped, GlobalMotorCommandsMap } from '../../hooks.client';
	import { page } from '$app/state';
	import ChatButton from './gora/chat-button.svelte';

	const commandGroups = GlobalMotorCommandsGrouped.size;

	let menuGroupsExpanded: boolean[] = $state(new Array(commandGroups).fill(false));

	let isAtleastOneExpanded: boolean = $derived.by(() => {
		return menuGroupsExpanded.includes(true);
	});

	let searchText = $state('');

	let motorCommandsGroupedFiltered: Map<string, number[]> = $state(
		new Map(GlobalMotorCommandsGrouped)
	);

	function handleSearch() {
		const tempCmds = new Map();
		for (const [group, commandsIds] of GlobalMotorCommandsGrouped) {
			const filteredCmdPerGroup = commandsIds
				.map((cmdid: number) => GlobalMotorCommandsMap.get(cmdid) as MotorCommandType)
				.filter((cmd: MotorCommandType) => {
					if (cmd != null)
						return cmd.CommandString.toLowerCase().includes(searchText.toLocaleLowerCase());
				});
			const cmdIdsFiltered = filteredCmdPerGroup.map((cmd: MotorCommandType) => cmd.CommandEnum);
			tempCmds.set(group, cmdIdsFiltered);
		}
		motorCommandsGroupedFiltered = tempCmds;

		if (searchText.length != 0) {
			//expand all when search input has some chars
			menuGroupsExpanded = new Array(commandGroups).fill(true);
		}
	}
</script>

<div class="flex flex-col items-center justify-center px-1 pb-10 pt-5">
	<a href="/" class="mx-auto mb-5" aria-labelledby="Gearotons logo" aria-label="Gearotons logo">
		<svg
			width="150"
			height="50"
			fill="currentColor"
			version="1.1"
			viewBox="0 0 270.93 79.375"
			xml:space="preserve"
			xmlns="http://www.w3.org/2000/svg"
			><defs
				><clipPath id="clipPath12383"
					><g clip-path="url(#clipPath12383)"
						><path
							d="m46.608 78.156c-2.0316 0.0051-2.3023-0.29213-3.6724-4.0265-1.4344-3.9096-1.6176-4.0914-6.0616-6.0154-4.5825-1.9839-4.5825-1.9839-8.022 0.11935-3.4396 2.1032-3.4396 2.1032-9.3206-3.7717-5.881-5.875-5.881-5.875-3.9288-9.5533 1.9522-3.6783 1.9522-3.6783 0.1952-7.8753-0.96635-2.3084-2.1712-4.4335-2.6775-4.7225-0.5063-0.289-2.4636-1.1599-4.3496-1.9353-3.2651-1.3424-3.4081-1.5137-2.9915-3.5841 0.24067-1.1959 0.43758-4.181 0.43758-6.6336 0-4.4593 0-4.4593 3.3848-4.4593 1.8617 0 3.8719-0.39347 4.4672-0.87438 0.59531-0.48091 1.7542-1.9967 2.5753-3.3685 1.4929-2.4941 1.4929-2.4941-0.24397-5.0343-0.95528-1.3971-1.7369-2.7078-1.7369-2.9128 0-0.20496 1.2977-1.0306 2.8837-1.8347 1.586-0.8041 2.9322-1.3521 2.9915-1.2179 0.05927 0.1343 2.6258 2.8233 5.7033 5.9757 5.5956 5.7315 5.5956 5.7315 4.1296 7.3243-0.80628 0.87604-2.0373 2.6945-2.7355 4.041-0.85115 1.6414-1.2825 4.0619-1.3088 7.3448-0.03101 3.8622 0.34634 5.716 1.7863 8.7757 1.0041 2.1336 2.8428 5.0305 4.086 6.4376 1.2432 1.4071 4.1579 3.5007 6.477 4.6524 2.3191 1.1517 5.6638 2.3096 7.4326 2.5732 1.8322 0.27304 4.8225 0.12204 6.9495-0.35106 2.0534-0.45668 4.9807-1.7282 6.5052-2.8257 2.7717-1.9953 2.7717-1.9953 8.5433 3.7704 5.7716 5.7657 5.7716 5.7657 4.2495 8.3294-0.83715 1.4101-1.6656 2.5637-1.841 2.5637-0.17541 0-1.523-0.68869-2.9947-1.5304-2.6758-1.5304-2.6758-1.5304-4.6336 0-1.0768 0.84174-2.3532 1.5304-2.8366 1.5304-0.48334 0-1.0698 0.70825-1.3032 1.5739-0.23343 0.86562-0.42875 2.7088-0.43403 4.0959-0.0093 2.522-0.0093 2.522-4.7608 2.9679-2.6131 0.24526-5.7381 0.44817-6.9444 0.4509zm36.502-27.834c-0.93402 0.92821-1.5689 1.1399-1.8867 0.62895-0.2634-0.42353-1.0446-0.77005-1.736-0.77005-0.69142 0-1.8304-0.62956-2.5311-1.399-0.7007-0.76945-2.1261-1.399-3.1674-1.399-1.0414 0-2.4727 0.63607-3.1806 1.4135-1.2863 1.4125-1.2885 1.4122-3.2765-0.48063-1.0941-1.0417-1.9894-2.4099-1.9894-3.0403s0.73187-1.8295 1.6264-2.6646c1.6264-1.5184 1.6264-1.5184 4.0081 0.22782 1.3099 0.96044 2.8744 1.7232 3.4767 1.6951 0.60227-0.02818 2.0453-0.6542 3.2067-1.3913 1.1614-0.73709 2.5116-1.5362 3.0004-1.7759 0.48885-0.23964 1.3564-0.05008 1.9279 0.42131 0.5715 0.47136 0.85755 1.1489 0.63567 1.5057-0.22187 0.35678-1.0102 0.4573-1.7519 0.22336-0.92192-0.2908-1.3485-0.09156-1.3485 0.62976 0 0.58031 0.31674 1.2496 0.70387 1.4874 0.38713 0.23778 0.70388 1.0818 0.70388 1.8757 0 1.1632 0.19276 1.2844 0.99315 0.62426 0.74594-0.61524 1.1176-0.619 1.4932-0.01512 0.27501 0.44221-0.13347 1.4336-0.90773 2.203zm-33.419-0.17369c-2.4942-0.0219-4.7694-0.58322-6.9596-1.717-1.7897-0.92642-4.134-2.7217-5.2098-3.9896-1.0757-1.2678-2.383-3.3181-2.905-4.5561-0.52203-1.238-0.94915-3.5358-0.94915-5.1061 0-1.5704 0.48048-3.7786 1.0677-4.9071 0.58725-1.1286 1.9969-2.5294 3.1325-3.113 1.1356-0.5836 3.599-1.0611 5.4743-1.0611 2.5935 0 4.3275 0.54518 7.2452 2.2778 2.7683 1.644 4.4873 3.3472 6.1774 6.1206 2.0596 3.3799 2.3064 4.2991 2.0486 7.6305-0.25418 3.2849-0.63309 4.0973-2.8548 6.1206-2.241 2.041-3.0255 2.3289-6.2673 2.3004zm12.88-18.925c-0.21792-0.03905-2.4906-2.1835-5.0503-4.7654-4.6541-4.6943-4.6541-4.6943-2.6395-6.935 1.1789-1.3112 2.0135-3.0341 2.0119-4.1533-0.0012-1.0519-0.65392-2.9742-1.4499-4.2718-0.79601-1.2976-1.2799-2.7928-1.0753-3.3226 0.20461-0.52989 0.80186-0.96344 1.3272-0.96344 0.52536 0 1.6677 0.75374 2.5386 1.675 1.0465 1.107 1.3194 1.8371 0.80498 2.153-0.48652 0.29881-0.60307 1.4413-0.3108 3.0467 0.25719 1.4127 0.87989 3.3792 1.3838 4.3699 0.5039 0.99073 2.1957 2.9501 3.7595 4.3541 1.5638 1.404 3.6604 2.7566 4.659 3.0057 0.9986 0.24909 2.8754 0.28197 4.1706 0.07312 1.8477-0.29798 2.6784-0.03764 3.8566 1.2086 1.3619 1.4407 1.3969 1.6748 0.37617 2.5167-0.94058 0.77576-1.4357 0.75128-3.0149-0.14912-1.0392-0.59252-3.0425-1.2524-4.4518-1.4663-2.1824-0.33129-2.8541-0.0862-4.5309 1.6531-1.0828 1.1231-2.147 2.0101-2.3649 1.971zm-20.936-12.027c-1.3002 0.85791-1.6953 0.76315-3.6565-0.87686-1.2094-1.0113-2.1988-2.2341-2.1988-2.7174 0-0.48325 0.63349-1.4484 1.4078-2.1447 0.77426-0.69634 1.4078-1.7479 1.4078-2.3367 0-0.58885-0.62276-1.7294-1.3839-2.5346-0.76115-0.80518-1.4738-2.5126-1.5837-3.7942-0.13608-1.5871 0.18228-2.5768 0.99822-3.1031 0.65891-0.42508 1.4167-0.55553 1.684-0.28989 0.2673 0.26563 0.08535 0.96274-0.40436 1.5491-0.74878 0.89663-0.65941 1.0662 0.56203 1.0662 0.79882 0 1.6482 0.31477 1.8874 0.69949 0.23926 0.38473 0.92533 0.69951 1.5246 0.69951 0.70682 0 0.93869-0.39078 0.66005-1.1124-0.23624-0.61181-0.24193-1.414-0.01264-1.7827 0.2548-0.40971 0.80303-0.35187 1.41 0.14878 0.54623 0.45052 0.99315 1.2737 0.99315 1.8294 0 0.55566-0.79186 2.042-1.7597 3.303-0.96783 1.261-1.7597 2.7714-1.7597 3.3565 0 0.58507 0.68677 1.9314 1.5261 2.9919 1.1076 1.3993 1.3383 2.2241 0.84103 3.0075-0.37681 0.59367-1.3411 1.5122-2.1428 2.0412z"
							stroke-width=".70168"
						/></g
					></clipPath
				></defs
			><g stroke-width=".26506"
				><path
					d="m113.33 35.629v14.977q-2.8667 1.5717-5.391 2.2651-2.4816 0.64716-5.0915 0.64716-6.9741 0-10.226-4.1603-3.2517-4.2066-3.2517-11.325 0-5.4547 1.8398-8.9679 1.8398-3.5594 4.9632-5.1773 3.1234-1.6179 7.1025-1.6179 2.61 0 5.006 0.73962 2.396 0.69339 4.407 2.0802l-2.4816 4.6688q-3.2518-2.0802-6.6318-2.0802-3.9791 0-5.9472 2.6349-1.9682 2.5887-1.9682 7.4424 0 5.1311 1.797 7.6735 1.8398 2.4962 5.7761 2.4962 2.2249 0 4.0219-0.73962v-6.2405h-5.9045l0.68457-5.316z"
				/><path
					d="m134.39 40.575q0 0.92452-0.17115 3.2358h-12.322q0.25672 2.5887 1.5831 3.8368 1.3264 1.2019 3.1662 1.2019 1.3692 0 2.6527-0.41604 1.2836-0.41603 2.7383-1.3406l1.9682 3.7905q-1.5403 1.2481-3.5512 1.9415t-4.3642 0.69339q-2.8239 0-5.0915-1.1094-2.2249-1.1094-3.594-3.5132-1.3264-2.45-1.3264-6.2867 0-3.5132 1.1124-6.0556 1.1552-2.5424 3.2945-3.8368 2.1821-1.3406 5.1343-1.3406 2.8239 0 4.792 1.2019 2.0109 1.2019 2.995 3.2821t0.98408 4.7151zm-8.6428-4.9462q-1.4975 0-2.4388 1.017-0.89851 0.97075-1.2408 3.0971h6.803v-0.13868q0-2.1264-0.85572-3.0509t-2.2677-0.92452z"
				/><path
					d="m146.22 31.376q3.7652 0 5.6478 1.6179 1.9254 1.5717 1.9254 5.2235v14.654h-4.9632l-0.47064-1.6179q-1.5831 1.2481-3.1662 1.7566-1.5403 0.50849-3.2517 0.50849-1.797 0-3.1662-0.73962-1.3692-0.73962-2.1393-2.0339-0.72736-1.3406-0.72736-3.0509 0-3.6519 3.3373-5.5471 3.3373-1.9415 8.7284-2.1726v-0.50849q0-1.2943-0.25671-2.0339-0.21394-0.73962-0.81294-1.0632-0.59901-0.36981-1.6687-0.36981-2.6955 0-6.1184 2.3575l-2.2249-3.7905q2.3104-1.6179 4.4925-2.4038 2.2249-0.78584 4.8348-0.78584zm-4.2786 15.532q0 1.017 0.55622 1.5717 0.55622 0.50849 1.6259 0.50849 1.7542 0 3.8507-1.2481v-4.0217q-3.1234 0.1849-4.5781 1.0632-1.4547 0.8783-1.4547 2.1264z"
				/><path
					d="m169.04 31.376q1.2408 0 2.3105 0.41604l-0.85573 6.333q-0.68458-0.27736-1.2408-0.41603-0.55622-0.13868-1.2836-0.13868-1.1124 0-2.1821 0.60094-1.0269 0.55471-2.0537 2.0339v12.666h-5.8189v-20.663l5.8189-0.60094v2.9122q2.1393-3.1434 5.3055-3.1434z"
				/><path
					d="m181.46 53.518q-3.209 0-5.4766-1.4792-2.2249-1.4792-3.3373-3.9754-1.1124-2.5424-1.1124-5.6396 0-3.9754 1.4119-6.4254 1.4547-2.45 3.808-3.5132 2.3532-1.1094 5.2627-1.1094 3.2517 0 5.4766 1.433 2.2677 1.3868 3.3801 3.883 1.1124 2.4962 1.1124 5.7783 0 3.8368-1.4119 6.333-1.3692 2.45-3.7652 3.6056-2.3532 1.1094-5.3482 1.1094zm0.2995-4.6688q2.3104 0 3.2517-1.7104 0.9413-1.7566 0.9413-4.7151 0-3.1434-1.0269-4.7613-0.98408-1.6179-3.0806-1.6179-2.2677 0-3.2945 1.6179-1.0269 1.5717-1.0269 4.7613 0 3.0047 1.0269 4.7151 1.0696 1.7104 3.209 1.7104z"
				/><path
					d="m207.92 51.993q-2.5244 1.5255-5.6478 1.5255-1.5831 0-2.9522-0.64716-1.3264-0.69339-2.1821-2.1726-0.85571-1.4792-0.85571-3.7443v-9.9386h-3.5085v-4.9462h3.5085v-4.6688l5.8189-0.8783v5.5471h5.3483l-0.59901 4.9462h-4.7492v8.9679q0 1.3868 0.42787 1.9415 0.47064 0.55471 1.2836 0.55471 0.59901 0 1.1552-0.13868 0.55621-0.1849 1.3692-0.55471z"
				/><path
					d="m218.33 53.518q-3.209 0-5.4766-1.4792-2.2249-1.4792-3.3373-3.9754-1.1124-2.5424-1.1124-5.6396 0-3.9754 1.4119-6.4254 1.4547-2.45 3.808-3.5132 2.3532-1.1094 5.2627-1.1094 3.2517 0 5.4766 1.433 2.2677 1.3868 3.3801 3.883 1.1124 2.4962 1.1124 5.7783 0 3.8368-1.4119 6.333-1.3692 2.45-3.7652 3.6056-2.3532 1.1094-5.3482 1.1094zm0.2995-4.6688q2.3104 0 3.2517-1.7104 0.9413-1.7566 0.9413-4.7151 0-3.1434-1.0269-4.7613-0.98408-1.6179-3.0806-1.6179-2.2677 0-3.2945 1.6179-1.0269 1.5717-1.0269 4.7613 0 3.0047 1.0269 4.7151 1.0696 1.7104 3.209 1.7104z"
				/><path
					d="m244.32 31.376q2.9522 0 4.4498 1.6179 1.4975 1.5717 1.4975 4.6226v15.255h-5.8189v-13.406q0-1.2943-0.25671-1.9877-0.21393-0.73962-0.77015-1.0632-0.55622-0.32358-1.5831-0.32358-1.7114 0-4.0219 1.4792v15.301h-5.8189v-20.663l5.8189-0.60094v2.0339q1.5831-1.0632 3.1662-1.6641 1.6259-0.60094 3.3373-0.60094z"
				/><path
					d="m261.24 53.518q-2.7383 0-4.9204-0.69339-2.1393-0.73962-4.0219-2.1726l2.4388-4.0217q1.5831 1.2481 3.209 1.8028 1.6259 0.50849 3.1234 0.50849 1.4119 0 2.0537-0.46226 0.68457-0.46226 0.68457-1.2481 0-0.50849-0.25671-0.8783-0.25672-0.41603-1.0696-0.78584-0.77015-0.41603-2.3104-0.8783l-1.2408-0.36981q-3.0806-0.92452-4.4498-2.4038-1.3264-1.4792-1.3264-4.0217 0-1.9415 0.98407-3.4207 0.98409-1.4792 2.7811-2.2651 1.797-0.83207 4.1075-0.83207 4.3642 0 7.9154 2.2651l-2.2249 4.0217q-1.7542-0.97075-2.9522-1.3406-1.198-0.36981-2.5672-0.36981-1.0696 0-1.6259 0.41603-0.51344 0.41603-0.51344 1.0632 0 0.46226 0.21394 0.78584 0.21393 0.27736 0.77015 0.55471 0.599 0.23113 1.8398 0.60094l1.4119 0.41604q3.2945 0.92452 4.792 2.5887 1.5403 1.6641 1.5403 4.2066 0 1.9877-0.9413 3.5594-0.8985 1.5717-2.8239 2.4962-1.8826 0.8783-4.6209 0.8783z"
				/></g
			><path
				d="m41.635 19.406c-1.3002 0.85791-1.6953 0.76315-3.6565-0.87686-1.2094-1.0113-2.1988-2.2341-2.1988-2.7174 0-0.48325 0.63349-1.4484 1.4078-2.1447 0.77426-0.69634 1.4078-1.7479 1.4078-2.3367 0-0.58885-0.62276-1.7294-1.3839-2.5346-0.76115-0.80518-1.4738-2.5126-1.5837-3.7942-0.13608-1.5871 0.18228-2.5768 0.99822-3.1031 0.65891-0.42508 1.4167-0.55553 1.684-0.28989 0.2673 0.26563 0.08535 0.96274-0.40436 1.5491-0.74878 0.89663-0.65941 1.0662 0.56203 1.0662 0.79882 0 1.6482 0.31477 1.8874 0.69949 0.23926 0.38473 0.92533 0.69951 1.5246 0.69951 0.70682 0 0.93869-0.39078 0.66005-1.1124-0.23624-0.61181-0.24193-1.414-0.01264-1.7827 0.2548-0.40971 0.80303-0.35187 1.41 0.14878 0.54623 0.45052 0.99315 1.2737 0.99315 1.8294 0 0.55566-0.79186 2.042-1.7597 3.303-0.96783 1.261-1.7597 2.7714-1.7597 3.3565 0 0.58507 0.68677 1.9314 1.5261 2.9919 1.1076 1.3993 1.3383 2.2241 0.84103 3.0075-0.37681 0.59367-1.3411 1.5122-2.1428 2.0412z"
				fill="#72bf44"
				stroke-width=".70168"
			/><g stroke-width=".70168"
				><path
					d="m62.571 31.433c-0.21792-0.03905-2.4906-2.1835-5.0503-4.7654-4.6541-4.6943-4.6541-4.6943-2.6395-6.935 1.1789-1.3112 2.0135-3.0341 2.0119-4.1533-0.0012-1.0519-0.65392-2.9742-1.4499-4.2718-0.79601-1.2976-1.2799-2.7928-1.0753-3.3226 0.20461-0.52989 0.80186-0.96344 1.3272-0.96344 0.52536 0 1.6677 0.75374 2.5386 1.675 1.0465 1.107 1.3194 1.8371 0.80498 2.153-0.48652 0.29881-0.60307 1.4413-0.3108 3.0467 0.25719 1.4127 0.87989 3.3792 1.3838 4.3699 0.5039 0.99073 2.1957 2.9501 3.7595 4.3541 1.5638 1.404 3.6604 2.7566 4.659 3.0057 0.9986 0.24909 2.8754 0.28197 4.1706 0.07312 1.8477-0.29798 2.6784-0.03764 3.8566 1.2086 1.3619 1.4407 1.3969 1.6748 0.37617 2.5167-0.94058 0.77576-1.4357 0.75128-3.0149-0.14912-1.0392-0.59252-3.0425-1.2524-4.4518-1.4663-2.1824-0.33129-2.8541-0.0862-4.5309 1.6531-1.0828 1.1231-2.147 2.0101-2.3649 1.971z"
				/><path
					d="m49.692 50.358c-2.4942-0.0219-4.7694-0.58322-6.9596-1.717-1.7897-0.92642-4.134-2.7217-5.2098-3.9896-1.0757-1.2678-2.383-3.3181-2.905-4.5561-0.52203-1.238-0.94915-3.5358-0.94915-5.1061 0-1.5704 0.48048-3.7786 1.0677-4.9071 0.58725-1.1286 1.9969-2.5294 3.1325-3.113 1.1356-0.5836 3.599-1.0611 5.4743-1.0611 2.5935 0 4.3275 0.54518 7.2452 2.2778 2.7683 1.644 4.4873 3.3472 6.1774 6.1206 2.0596 3.3799 2.3064 4.2991 2.0486 7.6305-0.25418 3.2849-0.63309 4.0973-2.8548 6.1206-2.241 2.041-3.0255 2.3289-6.2673 2.3004z"
				/><path
					d="m83.11 50.532c-0.93402 0.92821-1.5689 1.1399-1.8867 0.62895-0.2634-0.42353-1.0446-0.77005-1.736-0.77005-0.69142 0-1.8304-0.62956-2.5311-1.399-0.7007-0.76945-2.1261-1.399-3.1674-1.399-1.0414 0-2.4727 0.63607-3.1806 1.4135-1.2863 1.4125-1.2885 1.4122-3.2765-0.48063-1.0941-1.0417-1.9894-2.4099-1.9894-3.0403s0.73187-1.8295 1.6264-2.6646c1.6264-1.5184 1.6264-1.5184 4.0081 0.22782 1.3099 0.96044 2.8744 1.7232 3.4767 1.6951 0.60227-0.02818 2.0453-0.6542 3.2067-1.3913 1.1614-0.73709 2.5116-1.5362 3.0004-1.7759 0.48885-0.23964 1.3564-0.05008 1.9279 0.42131 0.5715 0.47136 0.85755 1.1489 0.63567 1.5057-0.22187 0.35678-1.0102 0.4573-1.7519 0.22336-0.92192-0.2908-1.3485-0.09156-1.3485 0.62976 0 0.58031 0.31674 1.2496 0.70387 1.4874 0.38713 0.23778 0.70388 1.0818 0.70388 1.8757 0 1.1632 0.19276 1.2844 0.99315 0.62426 0.74594-0.61524 1.1176-0.619 1.4932-0.01512 0.27501 0.44221-0.13347 1.4336-0.90773 2.203z"
				/><path
					d="m46.608 78.366c-2.0316 0.0051-2.3023-0.29213-3.6724-4.0265-1.4344-3.9096-1.6176-4.0914-6.0616-6.0154-4.5825-1.9839-4.5825-1.9839-8.022 0.11935-3.4396 2.1032-3.4396 2.1032-9.3206-3.7717-5.881-5.875-5.881-5.875-3.9288-9.5533 1.9522-3.6783 1.9522-3.6783 0.1952-7.8753-0.96635-2.3084-2.1712-4.4335-2.6775-4.7225-0.5063-0.289-2.4636-1.1599-4.3496-1.9353-3.2651-1.3424-3.4081-1.5137-2.9915-3.5841 0.24067-1.1959 0.43758-4.181 0.43758-6.6336 0-4.4593 0-4.4593 3.3848-4.4593 1.8617 0 3.8719-0.39347 4.4672-0.87438 0.59531-0.48091 1.7542-1.9967 2.5753-3.3685 1.4929-2.4941 1.4929-2.4941-0.24397-5.0343-0.95528-1.3971-1.7369-2.7078-1.7369-2.9128 0-0.20496 1.2977-1.0306 2.8837-1.8347 1.586-0.8041 2.9322-1.3521 2.9915-1.2179 0.05927 0.1343 2.6258 2.8233 5.7033 5.9757 5.5956 5.7315 5.5956 5.7315 4.1296 7.3243-0.80628 0.87604-2.0373 2.6945-2.7355 4.041-0.85115 1.6414-1.2825 4.0619-1.3088 7.3448-0.03101 3.8622 0.34634 5.716 1.7863 8.7757 1.0041 2.1336 2.8428 5.0305 4.086 6.4376 1.2432 1.4071 4.1579 3.5007 6.477 4.6524 2.3191 1.1517 5.6638 2.3096 7.4326 2.5732 1.8322 0.27304 4.8225 0.12204 6.9495-0.35106 2.0534-0.45668 4.9807-1.7282 6.5052-2.8257 2.7717-1.9953 2.7717-1.9953 8.5433 3.7704 5.7716 5.7657 5.7716 5.7657 4.2495 8.3294-0.83715 1.4101-1.6656 2.5637-1.841 2.5637-0.17541 0-1.523-0.68869-2.9947-1.5304-2.6758-1.5304-2.6758-1.5304-4.6336 0-1.0768 0.84174-2.3532 1.5304-2.8366 1.5304-0.48334 0-1.0698 0.70825-1.3032 1.5739-0.23343 0.86562-0.42875 2.7088-0.43403 4.0959-0.0093 2.522-0.0093 2.522-4.7608 2.9679-2.6131 0.24526-5.7381 0.44817-6.9444 0.4509z"
				/></g
			><g fill="#72bf44"
				><path
					transform="scale(.26458)"
					d="m221.99 104.37c-21.583-21.403-21.279-20.826-14.982-28.508 10.197-12.44 10.637-18.349 2.5488-34.177-4.2468-8.3105-4.6206-11.664-1.5261-13.691 1.9876-1.3023 2.2091-1.2819 5.6006 0.51733 3.9074 2.0729 9.7716 8.2318 9.7322 10.221-0.0138 0.70111-0.54856 1.9667-1.1882 2.8124-2.2758 3.0088-0.90367 13.355 3.2107 24.21 3.573 9.4267 18.638 24.496 30.157 30.166 3.6619 1.8024 4.5961 1.9032 16.018 1.7299l12.129-0.1841 3.9723 3.7156c5.8538 5.4756 6.1691 6.3832 3.1534 9.0778-3.0074 2.6871-5.7287 2.8323-10.008 0.53397-8.1041-4.353-21.98-7.3396-27.576-5.9353-1.109 0.27836-5.0935 3.3568-8.8544 6.8411-3.7609 3.4842-7.2364 6.335-7.7233 6.335-0.48695 0-7.086-6.1491-14.665-13.665z"
					stroke-width=".7934"
				/><path
					transform="scale(.26458)"
					d="m305.85 192.03c-1.4804-1.0519-3.5478-1.9126-4.5942-1.9126-2.5272 0-6.3056-1.9943-9.9259-5.239-7.9957-7.1662-17.36-6.7939-26.025 1.0348-2.9597 2.674-3.292 2.787-5.1972 1.7673-2.7769-1.4862-9.5203-8.9818-11.406-12.679-1.2033-2.3587-1.3692-3.4803-0.75391-5.0985 1.1968-3.1479 4.7901-7.5307 8.2-10.002 2.9299-2.1232 3.155-2.1637 5.4416-0.98129 1.3119 0.6784 4.0384 2.4212 6.059 3.8728 4.9626 3.5653 11.404 6.7298 13.68 6.7204 2.4177-0.01 8.3696-2.8053 17.51-8.2236 8.2849-4.9111 10.342-5.0795 13.674-1.1198 3.3233 3.9495 2.3619 4.9547-4.7616 4.9784-4.3777 0.0146-4.7737 0.16247-5.0159 1.8734-0.2794 1.9735 1.2571 6.4601 2.2123 6.4601 0.91526 0 2.236 3.4646 2.8295 7.4223 0.6098 4.0665 1.5049 4.4766 4.5471 2.0836 2.4102-1.8959 3.2324-1.9678 4.5362-0.3968 0.78452 0.94529 0.78542 1.6707 4e-3 3.5562-0.95668 2.3096-6.5489 7.9983-7.7296 7.863-0.32551-0.0373-1.8031-0.92849-3.2835-1.9804z"
					stroke-width=".7934"
				/><path
					d="m179.07 53.134c-0.70447-0.15325-1.6906-0.48766-2.1914-0.74313-1.3068-0.66668-3.1783-2.5339-3.8251-3.8164-1.7494-3.4687-1.8507-8.7435-0.23145-12.053 1.594-3.2581 5.7329-5.3322 9.967-4.9947 5.8022 0.46244 8.9898 4.3449 8.9978 10.959 5e-3 3.8032-0.93635 6.4387-2.982 8.3522-2.2935 2.1453-6.1962 3.0658-9.7349 2.296zm4.775-4.6392c2.962-1.4938 2.9376-10.49-0.0326-12.059-0.90411-0.47756-3.1151-0.52149-3.971-0.07889-1.6226 0.83905-2.3201 2.6372-2.3201 5.9809 0 4.8435 1.5645 6.9195 4.9254 6.5354 0.4611-0.05269 1.0903-0.22287 1.3982-0.37816z"
					stroke-width=".20992"
				/></g
			></svg
		>
	</a>

	<input
		bind:value={searchText}
		oninput={handleSearch}
		class="input input-sm my-3 w-full"
		placeholder="Search"
	/>

	<button
		title={`${isAtleastOneExpanded ? 'Collapse all' : 'Expand all'}`}
		class="btn btn-ghost btn-lg"
		onclick={() => {
			let tempExpanded = [];
			for (let grp of menuGroupsExpanded) {
				tempExpanded.push(!isAtleastOneExpanded);
			}
			menuGroupsExpanded = tempExpanded;
		}}
	>
		{#if isAtleastOneExpanded}
			<Icon icon="mdi:collapse-all-outline" />
		{:else}
			<Icon icon="mdi:expand-all-outline" />
		{/if}
	</button>
	<ul class="menu bg-base-200 rounded-box w-full">
		{#each motorCommandsGroupedFiltered as [key, value], index}
			<li>
				<details bind:open={menuGroupsExpanded[index]}>
					<summary class="">{key}</summary>
					<ul>
						{#each value as cmdid}
							<li class="mt-3">
								<a
									href={`/docs/${cmdid}`}
									class={`hover:bg-base-300 hover:text-primary ${cmdid == page.data.CommandId ? 'bg-base-300 text-primary' : ''} w-full rounded-l-lg rounded-r-full p-3 text-left text-sm`}
									>{GlobalMotorCommandsMap.get(cmdid)!.CommandString}</a
								>
							</li>
						{/each}
					</ul>
				</details>
			</li>
		{/each}
	</ul>
	<ChatButton />
</div>
